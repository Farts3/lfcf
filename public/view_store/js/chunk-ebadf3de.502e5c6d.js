(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ebadf3de"],{"0b65":function(t,e,a){"use strict";e["a"]={shortcuts:[{text:"今天",value:function(){var t=new Date,e=new Date;return e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())),[e,t]}},{text:"昨天",value:function(){var t=new Date,e=new Date;return e.setTime(e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-1))),t.setTime(t.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-1))),[e,t]}},{text:"最近7天",value:function(){var t=new Date,e=new Date;return e.setTime(e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-6))),[e,t]}},{text:"最近30天",value:function(){var t=new Date,e=new Date;return e.setTime(e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-29))),[e,t]}},{text:"本月",value:function(){var t=new Date,e=new Date;return e.setTime(e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),1))),[e,t]}},{text:"本年",value:function(){var t=new Date,e=new Date;return e.setTime(e.setTime(new Date((new Date).getFullYear(),0,1))),[e,t]}}]}},3554:function(t,e,a){},"5c3ac":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{staticClass:"mt15",attrs:{bordered:!1,"dis-hover":""}},[r("Form",{ref:"orderData",staticClass:"tabform",attrs:{model:t.orderData,"label-width":t.labelWidth,"label-position":t.labelPosition},nativeOn:{submit:function(t){t.preventDefault()}}},[r("Row",[6==t.currentTab||7==t.currentTab||5==t.currentTab?r("Col",{staticClass:"ivu-text-left mr"},[r("FormItem",{attrs:{label:"订单状态："}},[r("Select",{staticStyle:{width:"250px"},on:{"on-change":t.selectStatus},model:{value:t.orderData.status,callback:function(e){t.$set(t.orderData,"status",e)},expression:"orderData.status"}},t._l(t.statusList,(function(e){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1):t._e(),r("Col",{staticClass:"ivu-text-left mr"},[r("FormItem",{attrs:{label:"创建时间："}},[r("DatePicker",{staticStyle:{width:"250px"},attrs:{editable:!1,clearable:!0,value:t.timeVal,format:"yyyy/MM/dd",type:"datetimerange",placement:"bottom-start",placeholder:"自定义时间",options:t.options},on:{"on-change":t.onchangeTime}})],1)],1),4==t.currentTab?r("Col",{staticClass:"mr"},[r("FormItem",{attrs:{label:"会员类型："}},[r("Select",{staticStyle:{width:"250px"},attrs:{clearable:""},on:{"on-change":t.userSearchs},model:{value:t.vipData.member_type,callback:function(e){t.$set(t.vipData,"member_type",e)},expression:"vipData.member_type"}},t._l(t.treeSelect,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.label))])})),1)],1)],1):t._e(),4!=t.currentTab?r("Col",{staticClass:"mr"},[r("FormItem",{attrs:{label:"活动类型："}},[r("Select",{staticStyle:{width:"250px"},attrs:{clearable:""},on:{"on-change":t.userSearchs},model:{value:t.orderData.type,callback:function(e){t.$set(t.orderData,"type",e)},expression:"orderData.type"}},[r("Option",{attrs:{value:"0"}},[t._v("普通订单")]),r("Option",{attrs:{value:"1"}},[t._v("秒杀订单")]),r("Option",{attrs:{value:"2"}},[t._v("砍价订单")]),r("Option",{attrs:{value:"3"}},[t._v("拼团订单")]),r("Option",{attrs:{value:"4"}},[t._v("套餐订单")]),r("Option",{attrs:{value:"8"}},[t._v("预售订单")]),r("Option",{attrs:{value:"9"}},[t._v("新人订单")]),r("Option",{attrs:{value:"10"}},[t._v("抽奖订单")]),r("Option",{attrs:{value:"11"}},[t._v("拼单订单")]),r("Option",{attrs:{value:"12"}},[t._v("桌码订单")])],1)],1)],1):t._e(),r("Col",{staticClass:"ivu-text-left mr"},[r("FormItem",{attrs:{label:"选择店员："}},[r("Select",{staticStyle:{width:"250px"},attrs:{clearable:""},on:{"on-change":t.userSearchs},model:{value:t.orderData.staff_id,callback:function(e){t.$set(t.orderData,"staff_id",e)},expression:"orderData.staff_id"}},t._l(t.staffData,(function(e){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label)+"\n                ")])})),1)],1)],1),r("Col",{attrs:{span:"24"}},[r("Row",[r("Col",{staticClass:"mr"},[6==t.currentTab||7==t.currentTab||5==t.currentTab?r("FormItem",{attrs:{label:"订单号：","label-for":"real_name"}},[r("Input",{staticStyle:{width:"250px"},attrs:{"enter-button":"",placeholder:"订单号/商品名称"},model:{value:t.orderData.real_name,callback:function(e){t.$set(t.orderData,"real_name",e)},expression:"orderData.real_name"}}),r("Button",{staticClass:"ml20 search",attrs:{type:"primary"},on:{click:t.orderSearch}},[t._v("搜索")])],1):t._e(),3==t.currentTab||4==t.currentTab?r("FormItem",{attrs:{label:"用户搜索：","label-for":"nickname"}},[r("Input",{staticStyle:{width:"250px"},attrs:{"enter-button":"",placeholder:"请输入用户名"},model:{value:t.rechargeData.nickname,callback:function(e){t.$set(t.rechargeData,"nickname",e)},expression:"rechargeData.nickname"}}),r("Button",{staticClass:"ml20 search",attrs:{type:"primary"},on:{click:t.orderSearch}},[t._v("搜索")])],1):t._e()],1)],1)],1)],1)],1)],1),r("Card",{staticClass:"mt15",attrs:{bordered:!1,"dis-hover":""}},[Object.keys(t.tablists).length?r("div",{staticClass:"product_tabs tabbox mb20"},[r("Tabs",{on:{"on-click":t.onClickTab},model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},[r("TabPane",{attrs:{label:"收银台订单（"+t.tablists.cashier+"）",name:"6"}}),r("TabPane",{attrs:{label:"配送订单（"+t.tablists.delivery+"）",name:"7"}}),r("TabPane",{attrs:{label:"核销订单（"+t.tablists.writeoff+"）",name:"5"}}),r("TabPane",{attrs:{label:"充值订单（"+t.tablists.recharg+"）",name:"3"}}),r("TabPane",{attrs:{label:"付费会员订单（"+t.tablists.vip+"）",name:"4"}})],1)],1):t._e(),r("Row",{attrs:{type:"flex"}},[6==t.currentTab?r("Col",[r("Button",{directives:[{name:"auth",rawName:"v-auth",value:["order-cashier-cashier_scan"],expression:"['order-cashier-cashier_scan']"}],staticClass:"mr",attrs:{type:"primary"},on:{click:t.qrcodeShow}},[t._v("下载收银码")])],1):t._e(),r("Col",[r("Button",{directives:[{name:"auth",rawName:"v-auth",value:["order-export"],expression:"['order-export']"}],attrs:{icon:"ios-share-outline"},on:{click:t.exports}},[t._v("导出")])],1),r("Col",[r("Tooltip",{attrs:{content:"本页至少选中一项",disabled:!!t.selectArr.length}},[r("Button",{staticClass:"ml15",attrs:{type:"primary",disabled:!t.selectArr.length},on:{click:t.printOreder}},[t._v("打印配货单")])],1)],1)],1),r("Table",{staticClass:"ivu-mt",attrs:{columns:6==t.currentTab||7==t.currentTab||5==t.currentTab?t.columns:3==t.currentTab?t.rechargeColumns:t.vipColumns,data:t.tableList,loading:t.loading,"no-data-text":"暂无数据","highlight-row":"","no-filtered-data-text":"暂无筛选结果"},on:{"on-select-all":t.selectAll,"on-select-all-cancel":t.cancelAll,"on-select":t.TableSelectRow,"on-select-cancel":t.TableSelectCancelRow},scopedSlots:t._u([{key:"order_id",fn:function(e){var a=e.row;e.index;return[r("span",{staticStyle:{display:"block"},domProps:{textContent:t._s(a.order_id)}}),r("span",{directives:[{name:"show",rawName:"v-show",value:1===a.is_del&&null==a.delete_time,expression:"row.is_del === 1 && row.delete_time == null"}],staticStyle:{color:"#ed4014",display:"block"}},[t._v("用户已删除")])]}},{key:"userInfo",fn:function(e){var i=e.row;e.index;return[6==t.currentTab||7==t.currentTab||5==t.currentTab?r("div",{staticClass:"tabBox"},[r("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[i.uid?r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:i.avatar,expression:"row.avatar"}]}):r("img",{attrs:{src:a("586c")}})]),i.uid?r("span",{staticClass:"tabBox_tit"},[r("a",{on:{click:function(e){return t.showUserInfo(i)}}},[t._v(t._s(i.nickname)),r("span",{staticStyle:{"margin-left":"5px"}},[t._v("/"+t._s(i.uid))])])]):r("span",{staticClass:"tabBox_tit"},[t._v("\n              游客"),r("span",{staticStyle:{"margin-left":"5px"}},[t._v("/"+t._s(i.uid))])]),null!=i.delete_time?r("span",{staticStyle:{color:"#ed4014"}},[t._v("\n              (已注销)")]):t._e()]):t._e(),3==t.currentTab?r("div",{staticClass:"tabBox"},[r("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:i.avatar,expression:"row.avatar"}]})]),r("span",{staticClass:"tabBox_tit"},[t._v(t._s(i.nickname))])]):t._e(),4==t.currentTab&&i.user?r("div",{staticClass:"tabBox"},[r("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:i.user.avatar,expression:"row.user.avatar"}]})]),r("span",{staticClass:"tabBox_tit"},[t._v(t._s(i.user.nickname))])]):t._e()]}},{key:"info",fn:function(e){var a=e.row;e.index;return t._l(a._info,(function(e,a){return r("div",{key:a,staticClass:"tabBox"},[r("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.cart_info.productInfo.attrInfo?e.cart_info.productInfo.attrInfo.image:e.cart_info.productInfo.image,expression:"\n                  val.cart_info.productInfo.attrInfo\n                    ? val.cart_info.productInfo.attrInfo.image\n                    : val.cart_info.productInfo.image\n                "}]})]),r("span",{staticClass:"tabBox_tit"},[e.cart_info.is_gift?r("span",{staticClass:"font-color-red"},[t._v("[赠品]")]):t._e(),t._v(t._s(e.cart_info.productInfo.store_name+" | ")+t._s(e.cart_info.productInfo.attrInfo?e.cart_info.productInfo.attrInfo.suk:"")+"\n            ")]),r("span",{staticClass:"tabBox_pice"},[t._v(t._s("￥"+e.cart_info.truePrice+" x "+e.cart_info.cart_num))])])}))}},{key:"statusName",fn:function(e){var a=e.row;e.index;return[a.status_name?r("div",{staticClass:"pt5",domProps:{innerHTML:t._s(a.status_name.status_name)}}):t._e(),!a.is_all_refund&&a.refund.length?r("div",{staticClass:"trip"},[t._v("\n            部分退款中\n          ")]):t._e(),a.is_all_refund&&a.refund.length&&6!=a.refund_type?r("div",{staticClass:"trip"},[t._v("\n            退款中\n          ")]):t._e(),a.status_name?r("div",{staticClass:"pictrue-box"},t._l(a.status_name.pics||[],(function(e,i){return a.status_name.pics?r("div",{directives:[{name:"viewer",rawName:"v-viewer"}],key:i},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"item"}],staticClass:"pictrue mr10",attrs:{src:e}})]):t._e()})),0):t._e()]}},{key:"pay_price",fn:function(e){var a=e.row;e.index;return[t._v("\n          "+t._s(a.paid>0?a.pay_price:0)+"\n        ")]}},{key:"action",fn:function(e){var a=e.row;e.index;return[6==t.currentTab||7==t.currentTab||5==t.currentTab?r("a",[2!==a._status&&8!==a._status&&4!==a.status||null!==a.pinkStatus&&2!==a.pinkStatus||null!=a.delete_time?t._e():r("a",{on:{click:function(e){return t.sendOrder(a)}}},[t._v("发送货")]),2!=a.shipping_type||0!=a.status&&5!=a.status||1!=a.paid||0!==a.refund_status||null!=a.delete_time?t._e():r("a",{on:{click:function(e){return t.bindWrite(a)}}},[t._v("立即核销")]),(2!==a._status&&!a.split.length||null!==a.pinkStatus&&2!==a.pinkStatus||null!=a.delete_time)&&(2!=a.shipping_type||0!=a.status&&5!=a.status||1!=a.paid||null!=a.delete_time||0!==a.refund_status)?t._e():r("Divider",{attrs:{type:"vertical"}}),r("a",{on:{click:function(e){return t.changeMenu(a,"2")}}},[t._v("订单详情")])],1):t._e(),[3==t.currentTab||4==t.currentTab?r("a",{on:{click:function(e){return t.marker(a)}}},[t._v("订单备注")]):t._e(),3==t.currentTab&&(parseFloat(a.refund_price)||0)<parseFloat(a.price)&&null==a.delete_time?r("Divider",{attrs:{type:"vertical"}}):t._e(),3==t.currentTab&&(parseFloat(a.refund_price)||0)<parseFloat(a.price)&&null==a.delete_time?r("a",{on:{click:function(e){return t.rechRefund(a)}}},[t._v("立即退款")]):t._e()]]}}])}),r("div",{staticClass:"acea-row row-right page"},[6==t.currentTab||7==t.currentTab||5==t.currentTab?r("Page",{attrs:{total:t.total,current:t.orderData.page,"show-elevator":"","show-total":"","page-size":t.orderData.limit},on:{"on-change":t.pageChange}}):t._e(),3==t.currentTab?r("Page",{attrs:{total:t.total,current:t.orderData.page,"show-elevator":"","show-total":"","page-size":t.rechargeData.limit},on:{"on-change":t.pageChange}}):t._e(),4==t.currentTab?r("Page",{attrs:{total:t.total,current:t.orderData.page,"show-elevator":"","show-total":"","page-size":t.vipData.limit},on:{"on-change":t.pageChange}}):t._e()],1)],1),r("orderWriteOff",{ref:"writeOff",attrs:{orderNumId:t.orderNumId},on:{submitSuccess:t.submitSuccess}}),r("user-details",{ref:"userDetails"}),r("edit-from",{ref:"edits",attrs:{FromData:t.FromData},on:{submitFail:t.submitFail}}),r("details-from",{ref:"detailss",attrs:{orderDatalist:t.orderDatalist,orderId:t.orderId,"row-active":t.rowActive,formType:1}}),r("order-remark",{ref:"remarks",attrs:{orderId:t.orderId,currentTab:t.currentTab},on:{submitFail:t.submitFail}}),r("order-record",{ref:"record"}),r("order-send",{ref:"send",attrs:{orderId:t.orderId,status:t.status,pay_type:t.pay_type},on:{submitFail:t.submitFail}}),r("Modal",{attrs:{title:"收款码","footer-hide":""},model:{value:t.modalCode,callback:function(e){t.modalCode=e},expression:"modalCode"}},[r("div",[r("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"acea-row row-around code"},[t.spin?r("Spin",{attrs:{fix:""}}):t._e(),r("div",{staticClass:"acea-row row-column-around row-between-wrapper"},[r("div",{staticClass:"QRpic"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.qrcode&&t.qrcode.wechat,expression:"qrcode && qrcode.wechat"}]})]),r("span",{staticClass:"mt10"},[t._v("公众号收款码")])]),r("div",{staticClass:"acea-row row-column-around row-between-wrapper"},[r("div",{staticClass:"QRpic"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.qrcode&&t.qrcode.routine,expression:"qrcode && qrcode.routine"}]})]),r("span",{staticClass:"mt10"},[t._v("小程序收款码")])])],1)])])],1)},i=[],s=a("a34a"),n=a.n(s),o=a("2f62"),c=a("d708"),l=a("a464"),u=a("759d"),d=a("31b4"),h=a("1a84"),f=a("91b4"),m=a("5465"),p=a("7dc5"),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{staticClass:"order_box",attrs:{scrollable:"",title:"订单核销",width:"1000","footer-hide":""},on:{"on-cancel":t.cancel},model:{value:t.modals,callback:function(e){t.modals=e},expression:"modals"}},[a("Card",{attrs:{bordered:!1,"dis-hover":""}},[a("Table",{ref:"selection",attrs:{columns:t.columns,border:"",data:t.writeOffData,loading:t.loading,"no-data-text":"暂无数据","highlight-row":"","no-filtered-data-text":"暂无筛选结果"},on:{"on-selection-change":t.selectOne},scopedSlots:t._u([{key:"image",fn:function(e){var r=e.row;e.index;return[a("div",{staticClass:"product-data"},[a("img",{staticClass:"image",attrs:{src:r.cart_info.productInfo.image}}),a("div",{staticClass:"name line2"},[t._v("\n\t\t\t\t\t\t\t\t\t \t\t\t"+t._s(r.cart_info.productInfo.store_name)+"\n\t\t\t\t\t\t\t\t\t \t\t")])])]}},{key:"value",fn:function(e){var r=e.row;e.index;return[a("div",[t._v(t._s(r.cart_info.productInfo.attrInfo.suk))])]}},{key:"sellPrice",fn:function(e){var r=e.row;e.index;return[a("div",[t._v(t._s(r.cart_info.productInfo.attrInfo?r.cart_info.productInfo.attrInfo.price:r.cart_info.productInfo.price))])]}},{key:"price",fn:function(e){var r=e.row;e.index;return[a("div",[t._v(t._s(r.cart_info.truePrice))])]}},{key:"writeOff",fn:function(e){var r=e.row;e.index;return[r.is_writeoff?a("div",[t._v("已核销")]):a("div",{staticStyle:{color:"#F5222D"}},[t._v("待核销")])]}},{key:"cartNum",fn:function(e){var r=e.row;e.index;return[a("div",[t._v(t._s(r.write_times))])]}}])}),a("Button",{attrs:{type:"primary"},on:{click:t.submitWriteOff}},[t._v("确认核销")])],1)],1)},g=[],b=a("f8b7"),_={name:"orderRecord",props:{orderNumId:String},data:function(){var t=this;return{modals:!1,loading:!1,writeOffData:[],writeOffItem:[],columns:[{type:"selection",width:50,align:"center"},{title:"商品信息",slot:"image",align:"center",minWidth:150},{title:"规格",slot:"value",align:"center",minWidth:90},{title:"商品售价",slot:"sellPrice",align:"center",minWidth:60},{title:"商品优惠价",slot:"price",align:"center",minWidth:60},{title:"状态",slot:"writeOff",align:"center",minWidth:30},{title:"总数",slot:"cartNum",align:"center",minWidth:30},{title:"待核销数量",key:"surplus_num",align:"center",minWidth:130,render:function(e,a){return e("div",[e("InputNumber",{props:{min:1,max:a.row.numShow,value:a.row.write_surplus_times||1,disabled:!!a.row.is_writeoff},on:{"on-change":function(e){a.row.surplus_num=e||1,t.writeOffItem.length?t.writeOffItem.forEach((function(e){e.id==a.row.id?e.surplus_num=a.row.surplus_num:t.writeOffItem.push(a.row)})):t.writeOffItem.push(a.row),t.selectData.forEach((function(e,r){e.cart_id===a.row.cart_id&&t.selectData.splice(r,1,a.row)}))}}})])}}],selectData:[]}},methods:{cancel:function(){this.$refs.selection.selectAll(!1)},selectOne:function(t){var e=this;t.forEach((function(t){e.writeOffItem.forEach((function(e){t.id==e.id&&(t.surplus_num=e.surplus_num)}))})),this.selectData=t},getWriteOff:function(t){var e=this;Object(b["fb"])(t).then((function(t){var a=t.data.cart_info;a.forEach((function(t){t.numShow=t.surplus_num,t.is_writeoff&&(t._disabled=!0)})),e.writeOffData=a,e.writeOffItem=[]})).catch((function(t){e.$Message.error(res.msg)}))},submitWriteOff:function(){var t=this;if(!this.selectData.length)return this.$Message.error("请选择要核销的商品");var e=[];this.selectData.forEach((function(t){e.push({cart_id:t.cart_id,cart_num:t.surplus_num})})),Object(b["W"])(this.orderNumId,{cart_ids:e}).then((function(e){t.$Message.success(e.msg),t.modals=!1,t.$refs.selection.selectAll(!1),t.$emit("submitSuccess")})).catch((function(e){t.$Message.error(e.msg)}))}}},w=_,D=(a("a51a"),a("2877")),y=Object(D["a"])(w,v,g,!1,null,"1b78affa",null),k=y.exports,x=a("2e83"),T=a("0b65"),O=a("b4ea");function C(t,e,a,r,i,s,n){try{var o=t[s](n),c=o.value}catch(l){return void a(l)}o.done?e(c):Promise.resolve(c).then(r,i)}function $(t){return function(){var e=this,a=arguments;return new Promise((function(r,i){var s=t.apply(e,a);function n(t){C(s,r,i,n,o,"next",t)}function o(t){C(s,r,i,n,o,"throw",t)}n(void 0)}))}}function I(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function S(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?I(a,!0).forEach((function(e){M(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):I(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function M(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var L={name:"index",components:{userDetails:u["a"],editFrom:d["a"],detailsFrom:f["a"],orderRecord:m["a"],orderRemark:p["a"],orderWriteOff:k,orderSend:h["a"],expandRow:l["a"]},data:function(){return{qrcode:{},spin:!1,modalCode:!1,delfromData:{},pay_type:"",status:0,FromData:null,orderDatalist:null,orderId:0,orderNumId:"",options:T["a"],statusList:[{value:"",label:"全部"},{value:"0",label:"未支付"},{value:"1",label:"待配送"},{value:"2",label:"配送中"},{value:"5",label:"待核销"},{value:"6",label:"已核销"},{value:"3",label:"待评价"},{value:"4",label:"已完成"},{value:"-4",label:"已删除"}],treeSelect:[{id:"free",label:"试用"},{id:"month",label:"月卡"},{id:"quarter",label:"季卡"},{id:"year",label:"年卡"},{id:"ever",label:"永久"}],staffData:[],tablists:{},orderChartType:{},fromList:{title:"选择时间",custom:!0,fromTxt:[{text:"全部",val:""},{text:"今天",val:"today"},{text:"昨天",val:"yesterday"},{text:"最近7天",val:"lately7"},{text:"最近30天",val:"lately30"},{text:"本月",val:"month"},{text:"本年",val:"year"}]},timeVal:[],orderData:{page:1,limit:10,type:"",status:"",time:"",real_name:"",staff_id:"",order_type:6},rechargeData:{nickname:"",limit:15},vipData:{member_type:"",limit:15},currentTab:"6",tableList:[],total:0,loading:!1,rechargeColumns:[{title:"ID",key:"id",width:60},{title:"订单号",key:"order_id",minWidth:180},{title:"用户信息",slot:"userInfo",minWidth:200},{title:"支付金额",key:"price",minWidth:110},{title:"充值类型",key:"_recharge_type",minWidth:100},{title:"支付时间",key:"_pay_time",minWidth:130},{title:"关联店员",key:"staff_name",minWidth:100},{title:"操作",slot:"action",fixed:"right",minWidth:200,align:"center"}],vipColumns:[{title:"订单号",key:"order_id",minWidth:180},{title:"用户信息",slot:"userInfo",minWidth:200},{title:"会员类型",key:"member_type",minWidth:100},{title:"有效期限（天）",minWidth:100,render:function(t,e){return t("span",-1===e.row.vip_day?"永久":e.row.vip_day)}},{title:"支付金额",key:"pay_price",minWidth:100},{title:"支付方式",key:"pay_type",minWidth:100},{title:"购买时间",key:"pay_time",minWidth:130},{title:"关联店员",key:"staff_name",minWidth:120},{title:"操作",slot:"action",fixed:"right",minWidth:200,align:"center"}],columns:[{type:"expand",width:30,render:function(t,e){return t(l["a"],{props:{row:e.row}})}},{type:"selection",width:60,align:"center"},{title:"订单号",slot:"order_id",minWidth:160},{title:"用户信息",slot:"userInfo",minWidth:250},{title:"商品信息",slot:"info",minWidth:350},{title:"实际支付",slot:"pay_price",minWidth:120},{title:"支付方式",key:"pay_type_name",minWidth:120},{title:"收银店员",key:"clerk_name",minWidth:120},{title:"下单时间",key:"add_time",minWidth:130},{title:"订单状态",slot:"statusName",minWidth:120},{title:"操作",slot:"action",fixed:"right",minWidth:200,align:"center"}],rowActive:{},selectArr:[]}},watch:{$route:function(){this.$route.fullPath==="".concat(c["a"].routePre,"/order/index?order_type=7&status=1")&&this.getPath()}},computed:S({},Object(o["e"])("store/layout",["isMobile"]),{labelWidth:function(){return this.isMobile?void 0:80},labelPosition:function(){return this.isMobile?"top":"right"}}),created:function(){this.getTabs(),this.staffList(),this.$route.fullPath==="".concat(c["a"].routePre,"/order/index?order_type=7&status=1")?this.getPath():this.getList()},mounted:function(){},methods:{printOreder:function(){if(this.selectArr.length>10)return this.$Message.error("最多批量打印10个订单");var t=this.$router.resolve({path:"".concat(c["a"].routePre,"/order/distribution"),query:{id:this.selectArr.join(",")}});window.open(t.href,"_blank")},sortData:function(){var t=this;this.selectArr.length&&this.tableList.forEach((function(e){t.selectArr.includes(e.id)&&(e._checked=!0)}))},selectAll:function(){for(var t=this.tableList.length-1;t>=0;t--)this.TableSelectRow(null,this.tableList[t])},cancelAll:function(){for(var t=this.tableList.length-1;t>=0;t--)this.TableSelectCancelRow(null,this.tableList[t])},TableSelectRow:function(t,e){this.selectArr.includes(e.id)||this.selectArr.push(e.id)},TableSelectCancelRow:function(t,e){var a=this.selectArr.indexOf(e.id);-1!=a&&this.selectArr.splice(a,1)},rechRefund:function(t){var e=this;this.$modalForm(Object(b["Z"])(t.id)).then((function(){return e.getRecharge()}))},marker:function(t){this.orderId=t.id,this.$refs.remarks.modals=!0,3==this.currentTab&&this.$refs.remarks.getRemark(t.id),4==this.currentTab&&this.$refs.remarks.getVipRemark(t.id)},getPath:function(){this.orderData.page=1,this.currentTab=this.$route.query.order_type.toString(),this.orderData.order_type=this.currentTab,this.orderData.status=this.$route.query.status,this.getList()},qrcodeShow:function(){var t=this;this.spin=!0,this.modalCode=!0,Object(b["n"])().then((function(e){t.spin=!1,t.qrcode=e.data})).catch((function(e){t.spin=!1,t.$Message.error(e.msg)}))},splitOrderDetail:function(t){this.$router.push({path:"split_list",query:{id:t.id,orderChartType:this.orderData.status}})},changeMenu:function(t,e){var a=this;switch(this.orderId=t.id,e){case"1":this.delfromData={title:"修改立即支付",url:"/order/pay_offline/".concat(t.id),method:"post",ids:""},this.$modalSure(this.delfromData).then((function(e){a.$Message.success(e.msg),a.getChart(),a.getData(t.id,1),a.getList()})).catch((function(t){a.$Message.error(t.msg)}));break;case"2":this.rowActive=t,this.getData(t.id);break;case"3":this.$refs.record.modals=!0,4==this.currentTab?this.$refs.record.getVip(t.id):this.$refs.record.getList(t.id);break;case"4":this.$refs.remarks.modals=!0,3==this.currentTab&&this.$refs.remarks.getRemark(t.id),4==this.currentTab&&this.$refs.remarks.getVipRemark(t.id),this.$refs.remarks.formValidate.remark=t.remark;break;case"5":this.getOnlyRefundData(t.id,t.refund_type);break;case"55":this.getRefundData(t.id,t.refund_type);break;case"8":this.delfromData={title:"修改确认收货",url:"/order/take/".concat(t.id),method:"put",ids:""},this.$modalSure(this.delfromData).then((function(e){a.$Message.success(e.msg),a.getList(),a.getData(t.id,1)})).catch((function(t){a.$Message.error(t.msg)}));break;case"10":this.delfromData={title:"立即打印订单",info:"您确认打印此订单吗?",url:"/order/print/".concat(t.id),method:"get",ids:""},this.$modalSure(this.delfromData).then((function(t){a.$Message.success(t.msg),a.getList()})).catch((function(t){a.$Message.error(t.msg)}));break;case"11":this.delfromData={title:"立即打印电子面单",info:"您确认打印此电子面单吗?",url:"/order/order_dump/".concat(t.id),method:"get",ids:""},this.$modalSure(this.delfromData).then((function(t){a.$Message.success(t.msg),a.getList()})).catch((function(t){a.$Message.error(t.msg)}));break;case"12":var r=this.$router.resolve({path:"".concat(c["a"].routePre,"/order/distribution"),query:{id:t.id}});window.open(r.href,"_blank");break;default:this.delfromData={title:"删除订单",url:"/order/del/".concat(t.id),method:"DELETE",ids:""},this.delOrder(t,this.delfromData)}},getOnlyRefundData:function(t,e){var a=this;this.$modalForm(Object(b["B"])(t)).then((function(){a.getChart(),a.getList(),a.$refs.detailss.modals=!1}))},getRefundData:function(t,e){var a=this;this.orderData.status;this.delfromData={title:"是否立即退货",url:"/refund/agree/".concat(t),method:"get"},this.$modalSure(this.delfromData).then((function(t){a.$Message.success(t.msg),a.getChart(),a.getList()})).catch((function(t){a.$Message.error(t.msg)}))},delOrder:function(t,e){var a=this;if(1===t.is_del)this.$modalSure(e).then((function(t){a.$Message.success(t.msg),a.getList(),a.$refs.detailss.modals=!1})).catch((function(t){a.$Message.error(t.msg)}));else{var r="错误！",i="<p>您选择的的订单存在用户未删除的订单，无法删除用户未删除的订单！</p>";this.$Modal.error({title:r,content:i})}},getData:function(t,e){var a=this;Object(b["r"])(t).then(function(){var t=$(n.a.mark((function t(r){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e||(a.$refs.detailss.modals=!0),a.$refs.detailss.activeName="detail",a.orderDatalist=r.data,a.orderDatalist.orderInfo.refund_reason_wap_img)try{a.orderDatalist.orderInfo.refund_reason_wap_img=JSON.parse(a.orderDatalist.orderInfo.refund_reason_wap_img)}catch(i){a.orderDatalist.orderInfo.refund_reason_wap_img=[]}case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){a.$Message.error(t.msg)}))},submitSuccess:function(){this.getList(),this.getChart(),this.$refs.detailss.modals&&this.getData(this.orderId,1)},singleWrite:function(t){var e=this;this.$Modal.confirm({title:"提示",content:"确定要核销该订单吗？",cancelText:"取消",closable:!0,maskClosable:!0,onOk:function(){Object(b["gb"])(t.order_id).then((function(t){e.$Message.success(t.msg),e.getList(),e.getChart(),e.$refs.detailss.modals&&e.getData(e.orderId,1)})).catch((function(t){e.$Message.error(t.msg)}))},onCancel:function(){}})},bindWrite:function(t){var e=this;t.total_num>1?(this.orderNumId=t.order_id,this.$refs.writeOff.modals=!0,this.$refs.writeOff.getWriteOff({oid:t.id})):4==t.product_type?this.$modalForm(Object(b["O"])(t.id)).then((function(t){e.$Message.success(t.msg),e.getList(),e.getChart(),e.$refs.detailss.modals&&e.getData(e.orderId,1)})):this.singleWrite(t)},delivery:function(t){var e=this;Object(b["s"])(t.id).then(function(){var t=$(n.a.mark((function t(a){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.FromData=a.data,e.$refs.edits.modals=!0,e.getData(e.orderId,1);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$Message.error(t.msg)}))},edit:function(t){this.getOrderData(t.id)},getOrderData:function(t){var e=this;Object(b["y"])(t).then(function(){var t=$(n.a.mark((function t(a){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!1!==a.data.status){t.next=2;break}return t.abrupt("return",e.$authLapse(a.data));case 2:e.$authLapse(a.data),e.FromData=a.data,e.$refs.edits.modals=!0;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$Message.error(t.msg)}))},submitFail:function(){this.status=0,4==this.currentTab?this.getVipOrder():3==this.currentTab?this.getRecharge():(this.getList(),this.getData(this.orderId,1))},sendOrder:function(t){var e=this;this.$store.commit("store/order/setSplitOrder",t.total_num),this.$refs.send.modals=!0,this.orderId=t.id,this.status=t._status,this.pay_type=t.pay_type,this.$refs.send.getList(),this.$refs.send.getDeliveryList(),this.$nextTick((function(a){e.$refs.send.getCartInfo(t._status,t.id)}))},showUserInfo:function(t){this.$refs.userDetails.modals=!0,this.$refs.userDetails.getDetails(t.uid)},clearData:function(){this.orderData={page:1,limit:10,type:"",status:"",time:"",real_name:"",order_type:6},this.rechargeData={nickname:"",limit:15},this.vipData={member_type:"",limit:15}},staffList:function(){var t=this;Object(O["p"])().then((function(e){t.staffData=e.data})).catch((function(e){t.$Message.error(e.msg)}))},getTabs:function(){var t=this;Object(b["I"])().then((function(e){t.tablists=e.data})).catch((function(e){t.$Message.error(e.msg)}))},getChart:function(){var t=this;Object(b["E"])({type:this.currentTab}).then((function(e){t.orderChartType=e.data})).catch((function(e){t.$Message.error(e.msg)}))},onClickTab:function(){this.clearData(),this.orderData.order_type=this.currentTab,this.orderData.page=1,this.selectArr=[],this.timeVal=[],this.getChart(),this.searchList(),this.getTabs()},searchList:function(){3==this.currentTab?this.getRecharge():4==this.currentTab?this.getVipOrder():this.getList()},userSearchs:function(){this.orderData.page=1,this.searchList()},selectStatus:function(){this.orderData.page=1,this.getList()},getVipOrder:function(){var t=this;this.loading=!0,this.vipData.name=this.rechargeData.nickname,this.vipData.add_time=this.orderData.time,this.vipData.staff_id=this.orderData.staff_id,this.vipData.page=this.orderData.page,Object(b["N"])(this.vipData).then((function(e){var a=e.data;t.tableList=a.list,t.total=a.count,t.loading=!1,t.tablists.vip=a.count})).catch((function(e){t.loading=!1,t.$Message.error(e.msg)}))},getRecharge:function(){var t=this;this.loading=!0,this.rechargeData.data=this.orderData.time,this.rechargeData.staff_id=this.orderData.staff_id,this.rechargeData.page=this.orderData.page,Object(b["K"])(this.rechargeData).then((function(e){var a=e.data;t.tableList=a.list,t.total=a.count,t.loading=!1,t.tablists.recharg=a.count})).catch((function(e){t.loading=!1,t.$Message.error(e.msg)}))},getList:function(){var t=this;this.getChart(),this.loading=!0,Object(b["J"])(this.orderData).then((function(e){var a=e.data;a.data.forEach((function(e){e.id==t.orderId&&(t.rowActive=e)})),t.tableList=a.data,t.total=a.count,t.sortData(),t.loading=!1,5==t.currentTab?t.tablists.writeoff=a.count:6==t.currentTab?t.tablists.cashier=a.count:7==t.currentTab&&(t.tablists.delivery=a.count)})).catch((function(e){t.loading=!1,t.$Message.error(e.msg)}))},pageChange:function(t){this.orderData.page=t,this.searchList()},orderSearch:function(){this.orderData.page=1,this.searchList()},onchangeTime:function(t){this.timeVal=t,this.orderData.time=this.timeVal.join("-"),this.orderData.page=1,t[0]||(this.orderData.time=""),this.searchList()},selectChange:function(){this.orderData.page=1,this.timeVal=[],this.searchList()},exports:function(){var t=$(n.a.mark((function t(){var e,a,r,i,s,o,c,l;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e={orderType:this.currentTab,staff_id:this.orderData.staff_id},6==this.currentTab||7==this.currentTab||5==this.currentTab?(e.status=this.orderData.status,e.real_name=this.orderData.real_name,e.time=this.orderData.time,e.ids=this.selectArr.join(",")):3==this.currentTab?(e.nickname=this.rechargeData.nickname,e.data=this.orderData.time):(e.member_type=this.vipData.member_type,e.name=this.rechargeData.nickname,e.add_time=this.orderData.time),a=[],r=[],i=[],s="",o=JSON.parse(JSON.stringify(e)),o.page=1,c=0;case 6:if(!(c<o.page+1)){t.next=23;break}return t.next=9,this.getExcelData(o);case 9:if(l=t.sent,s||(s=l.filename),r.length||(r=l.filekey),a.length||(a=l.header),!l.export.length){t.next=18;break}i=i.concat(l.export),o.page++,t.next=20;break;case 18:return Object(x["a"])(a,r,s,i),t.abrupt("return");case 20:c++,t.next=6;break;case 23:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getExcelData:function(t){var e=this;return new Promise((function(a,r){var i=1;i=6==e.currentTab||7==e.currentTab||5==e.currentTab?1:3==e.currentTab?2:3,Object(b["G"])(t,i).then((function(t){return a(t.data)}))}))}}},W=L,P=(a("d4ae"),Object(D["a"])(W,r,i,!1,null,"72f25b3c",null));e["default"]=P.exports},a51a:function(t,e,a){"use strict";var r=a("f2e8"),i=a.n(r);i.a},d4ae:function(t,e,a){"use strict";var r=a("3554"),i=a.n(r);i.a},f2e8:function(t,e,a){}}]);