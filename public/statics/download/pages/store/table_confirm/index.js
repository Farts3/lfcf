(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/store/table_confirm/index"],{3380:function(t,e,a){},"35ca":function(t,e,a){"use strict";var n=a("e05e"),r=a.n(n);r.a},"47c2":function(t,e,a){"use strict";a.r(e);var n=a("9357"),r=a("e9d8");for(var i in r)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("35ca"),a("fb1e");var o=a("f0c5"),c=Object(o["a"])(r["default"],n["b"],n["c"],!1,null,"d488deac",null,!1,n["a"],void 0);e["default"]=c.exports},9357:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){}));var n=function(){var t=this.$createElement,e=(this._self._c,this.tablePartake.length);this.$mp.data=Object.assign({},{$root:{g0:e}})},r=[]},adac:function(t,e,a){"use strict";(function(t){var n=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(a("5c3b")),i=a("f8b7");function o(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(!t)return;if("string"===typeof t)return c(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return c(t,e)}(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,u=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return o=t.done,t},e:function(t){u=!0,i=t},f:function(){try{o||null==a.return||a.return()}finally{if(u)throw i}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}var u={mixins:[r.default],data:function(){return{statusBarHeight:0,navBarHeight:0,tablePartake:[],codeData:{}}},computed:{goodsNumber:function(){var t=0;return this.tablePartake.forEach((function(e){t=e.goods.reduce((function(t,e){return t+e.cart_num}),t)})),t},total:function(){var t=this,e=0;return this.tablePartake.forEach((function(a){e=a.goods.reduce((function(e,a){return t.$util.$h.Add(e,t.$util.$h.Mul(a.truePrice,a.cart_num))}),e)})),e}},onLoad:function(e){var a=this,n=e.tableId,r=t.getMenuButtonBoundingClientRect(),i=r.height,o=r.top;t.getSystemInfo({success:function(t){var e=t.statusBarHeight;a.statusBarHeight=e,a.navBarHeight=2*(o-e)+i}}),this.tableId=n,this.getCodeData(),this.getTablePartake()},onPullDownRefresh:function(){this.getTablePartake()},methods:{getCodeData:function(){var t=this;(0,i.getCodeData)({tableId:this.tableId}).then((function(e){t.codeData=e.data}))},getTablePartake:function(e){var a=this;(0,i.getTablePartake)({tableId:this.tableId}).then((function(n){var r=n.data,i=[];if(Object.keys(r).forEach((function(t){i.push(r[t])})),a.tablePartake=i,t.stopPullDownRefresh(),e){var c,u=!0,l=o(a.tablePartake);try{for(l.s();!(c=l.n()).done;){var f=c.value;if(!u)break;var s,d=o(f.goods);try{for(d.s();!(s=d.n()).done;){var h=s.value;if(u=h.is_true_stock,!u)break}}catch(b){d.e(b)}finally{d.f()}}}catch(b){l.e(b)}finally{l.f()}if(!u)return a.$util.Tips({title:"存在库存不足的商品，请检查"});e()}})).catch((function(t){a.$util.Tips({title:t})}))},settleTable:function(){var e=this;(0,i.settleTable)({tableId:this.tableId}).then((function(a){t.navigateTo({url:"/pages/goods/order_confirm/index?new=1&delivery_type=2&cartId=".concat(a.data.cartIds,"&store_id=").concat(e.codeData.store_id,"&tableId=").concat(e.tableId)})})).catch((function(t){e.$util.Tips({title:t})}))},onSettle:function(){var e=this;t.showModal({title:"是否结账",content:"您是否确认结算当前账单",success:function(t){var a=t.confirm;a&&e.getTablePartake(e.settleTable)}})},onAdd:function(){t.navigateTo({url:"/pages/store/table_code/index?store_id=".concat(this.codeData.store_id,"&qrcode_id=").concat(this.codeData.id)})},getTableCode:function(t){var e=this;(0,i.getTableCode)({tableId:this.tableId}).then((function(a){var n=a.data.table.status;switch(n){case-1:case 2:case 3:e.$util.Tips({title:-1==n?"本单已取消":"本单已结账"});break;default:t();break}})).catch((function(t){e.$util.Tips({title:t})}))}}};e.default=u}).call(this,a("543d")["default"])},e05e:function(t,e,a){},e9d8:function(t,e,a){"use strict";a.r(e);var n=a("adac"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=r.a},fb1e:function(t,e,a){"use strict";var n=a("3380"),r=a.n(n);r.a},fe5e:function(t,e,a){"use strict";(function(t,e){var n=a("4ea4");a("59a4");n(a("66fd"));var r=n(a("47c2"));t.__webpack_require_UNI_MP_PLUGIN__=a,e(r.default)}).call(this,a("bc2e")["default"],a("543d")["createPage"])}},[["fe5e","common/runtime","common/vendor"]]]);